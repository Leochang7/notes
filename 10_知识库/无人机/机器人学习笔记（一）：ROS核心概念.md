
#### **1. ROS Master (ROS主节点)**

*   **定义**: `ROS Master` 是一个作为ROS系统名称服务的独立进程。它的主要功能是维护一个注册表，记录了所有活跃的节点（Nodes）以及它们发布的和订阅的话题（Topics）、提供的服务（Services）等信息。
*   **功能**:
    1.  **名称注册**: 当任何一个ROS节点启动时，它会向Master注册自己的信息，包括节点名、发布的话题、订阅的话题、提供的服务等。
    2.  **名称查找**: 当一个节点想要订阅某个话题或调用某个服务时，它会向Master查询该话题或服务的提供者（即另一个节点）的网络地址（IP和端口）。
    3.  **连接协商**: Master将查询到的提供者地址返回给请求节点。之后，两个节点之间会建立一个直接的点对点（Peer-to-Peer）连接（例如，使用TCPROS协议）来传输数据。
*   **关键点**: Master是通信建立的**协调者**，但**不参与**节点间建立连接后的实际数据传输（话题数据不经过Master）。它的存在是实现整个分布式系统动态发现和连接的基础。
*   **启动方式**: 通过 `roscore` 命令启动。该命令同时也会启动参数服务器。
#### **2. Nodes (节点)**

*   **定义**: 一个`Node`是ROS中可执行程序的最小单元。在功能上，一个设计良好的节点通常负责一个单一、明确的任务（例如，驱动一个激光雷达、执行路径规划、控制电机）。
*   **特性**:
    1.  **独立性**: 每个节点都是一个独立的操作系统进程。一个节点的崩溃通常不会导致其他节点崩溃，这提高了整个系统的健壮性。
    2.  **模块化与可重用性**: 将复杂功能分解为多个简单的节点，使得代码更易于管理、调试和重用。
    3.  **语言无关性**: ROS的通信机制是标准化的。因此，用C++编写的节点可以无缝地与用Python编写的节点交换数据。
*   **常用命令**: `rosrun <包名> <节点名>` `(运行一个节点), `rosnode list` (列出当前所有运行的节点)
#### **3. 通信机制 I: Topics & Messages (话题 & 消息)**

这是一种基于**发布/订阅 (Publish/Subscribe)**模式的异步、多对多通信机制。

*   **Messages (消息)**
    *   **定义**: `Message`是一种严格定义的数据结构，用于在话题上传输数据。它们在`.msg`文件中定义，由基本数据类型（如`int32`, `float64`, `string`）或其他消息类型组合而成。
    *   **作用**: 消息类型定义了话题上数据交换的API或“契约”。所有在同一话题上通信的节点都必须使用完全相同的消息类型。

*   **Topics (话题)**
    *   **定义**: `Topic`是一个命名的、单向的数据传输通道。节点可以向一个话题发布（Publish）数据，也可以从一个话题订阅（Subscribe）数据。
    *   **特性**:
        *   **异步性**: 发布者发布消息时，不等待任何确认。它不关心是否有订阅者，或者有多少订阅者。
        *   **多对多**: 一个话题可以有多个发布者和多个订阅者。
        *   **匿名性**: 节点之间通过话题名进行解耦。发布者和订阅者都不知道对方的存在，只知道共同的话题名称。

*   **Publishers & Subscribers (发布者 & 订阅者)**
    *   **定义**: 它们是节点内部用于与话题交互的编程接口对象。
    *   `Publisher`: 节点通过它将特定类型的消息序列化后发送到指定的话题。
    *   `Subscriber`: 节点通过它从指定的话题接收数据。每当有新消息到达时，会触发一个用户定义的回调函数（Callback Function）来处理反序列化后的消息数据。
- **常用命令**: `rostopic list` (列出所有话题), `rostopic echo <话题名>` (实时查看话题内容), `rostopic info <话题名>` (查看话题信息), `rosmsg show <消息类型>` (查看消息结构)
#### **4. 通信机制 II: Services (服务)**

这是一种基于**远程过程调用 (Remote Procedure Call, RPC)**模型的同步、一对一通信机制。

*   **定义**: `Service`用于实现请求/响应（Request/Reply）式的交互。它由两部分消息结构定义（在`.srv`文件中，用`---`分隔）：请求（Request）和响应（Reply）。
*   **工作流程**:
    1.  一个节点（**Server**）提供一个服务，并向Master注册。
    2.  另一个节点（**Client**）向Master查询该服务的地址，并建立一个到Server的持久连接。
    3.  Client发送一个请求消息给Server。
    4.  Client的程序执行流会**阻塞**，直到收到Server的响应。
    5.  Server在接收到请求后，执行相应的计算或操作，然后将一个响应消息返回给Client。
    6.  Client收到响应后，解除阻塞，继续执行。
*   **适用场景**: 用于需要确认结果的一次性事务，例如“请求机器人拍照并返回图像”、“请求计算一条路径并返回路径点”、“请求解锁无人机并返回是否成功”。
- **常用命令**: `rosservice list, rosservice call <服务名> [请求内容]`, `rossrv show <服务类型>`
#### **5. Parameter Server (参数服务器)**

*   **定义**: 参数服务器是一个由ROS Master维护的全局字典（键-值存储）。它允许节点在运行时存储和检索配置参数。
*   **功能**:
    1.  **集中配置**: 提供了一个中心位置来存储非代码逻辑的配置信息，如PID增益、物理尺寸、传感器校准数据、文件名等。
    2.  **动态重配**: 可以在不停止和重新编译节点的情况下，通过命令行工具或代码动态地修改参数，便于调试和调优。
    3.  **数据类型**: 支持XML-RPC支持的基本数据类型，包括整型、浮点型、布尔型、字符串、列表和字典结构。
- **常用命令**: rosparam list, rosparam get <参数名>, rosparam set <参数名> <值>
---

### **概念总结表**

| 概念 | 核心功能 | 通信模型/特性 |
| :--- | :--- | :--- |
| **ROS Master** | 名称服务与发现 | - |
| **Nodes** | 执行具体任务的独立进程 | 模块化，语言无关，进程独立 |
| **Topics** | 命名的数据总线，用于连续数据流 | 异步，多对多，发布/订阅模型 |
| **Messages** | 话题上传输数据的严格类型定义 | 强类型数据结构 |
| **Services** | 用于一次性事务的请求/响应接口 | 同步，一对一，远程过程调用(RPC)模型 |
| **Parameter Server**| 全局的键-值存储，用于配置数据 | 集中式，动态可配置 |
